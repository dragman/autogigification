<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Autogigification | Playlist Builder</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600&family=Manrope:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="badge">Setlist.fm -> Spotify</div>
    <div>
      <h1>Autogigification Control Room</h1>
      <p class="lede">
        Because nobody likes being surprised by a setlist.
      </p>
    </div>
  </header>

  <main>
    <section class="card">
      <form id="playlist-form">
        <label class="grid-span-2">
          <span class="field-title">Band names (comma or new line)</span>
          <textarea id="band_names" name="band_names" placeholder="Band A, Band B&#10;Artist C"></textarea>
        </label>

        <label>
          <span class="field-title">Playlist name <span class="hint">(set to create, leave empty to preview)</span></span>
          <input type="text" id="playlist_name" name="playlist_name" placeholder="Tour Warmup 2024" />
          <span class="hint" id="playlist_hint"></span>
        </label>

        <details class="advanced">
          <summary>Advanced options (endpoint, token, caching, limits)</summary>
          <div class="advanced-content">
            <label class="grid-span-2">
              <span class="field-title">Lambda endpoint URL</span>
              <input type="url" id="endpoint" name="endpoint" value="https://24n2uybzmrhy5gdubam2dvvjby0dtkfh.lambda-url.eu-north-1.on.aws/" required />
            </label>

            <label>
              <span class="field-title">Bearer token (only for playlist creation)</span>
              <input type="text" id="token" name="token" placeholder="my-secret-token" />
            </label>

            <div class="toggles">
              <input type="checkbox" id="no_cache" name="no_cache" checked />
              <label for="no_cache" style="margin: 0;">Skip caches (send <code>no_cache: true</code>)</label>
            </div>

            <div class="toggles">
              <input type="checkbox" id="force_smart_setlist" name="force_smart_setlist" />
              <label for="force_smart_setlist" style="margin: 0;">Force setlist estimation (even if fresh)</label>
            </div>

            <div class="toggles">
              <input type="checkbox" id="use_fuzzy_search" name="use_fuzzy_search" checked />
              <label for="use_fuzzy_search" style="margin: 0;">Fuzzy track name matching</label>
            </div>

            <label>
              <span class="field-title">Copy last setlist threshold (days)</span>
              <input type="number" id="copy_last_setlist_threshold" name="copy_last_setlist_threshold" min="1" value="15" />
            </label>

            <label>
              <span class="field-title">Max setlist length (songs)</span>
              <input type="number" id="max_setlist_length" name="max_setlist_length" min="1" value="12" />
            </label>

            <label>
              <span class="field-title">Rate limit (seconds, 0 for none)</span>
              <input type="number" id="rate_limit" name="rate_limit" min="0" step="0.1" value="1" />
            </label>

            <div class="toggles">
              <input type="checkbox" id="local_mode" name="local_mode" />
              <label for="local_mode" style="margin: 0;">Local Lambda mode (wrap request & use local invoke URL)</label>
            </div>
          </div>
        </details>

        <div class="controls grid-span-2">
          <button type="submit" id="submit-btn">Build Spotify Playlist</button>
          <div class="status-line" id="status-line">
            <span class="dot" id="status-dot"></span>
            <span id="status-text">Idle</span>
          </div>
        </div>
      </form>
    </section>

    <section class="card">
      <p class="panel-title">Results</p>
      <div id="setlist-summary" class="setlist-grid"></div>
      <div id="response-link" class="response-link"></div>
    </section>

    <details class="advanced">
      <summary>Debug details (payload + raw response)</summary>
      <div class="advanced-content">
        <div class="card">
          <p class="panel-title">Payload preview</p>
          <pre id="payload-preview">{}</pre>
        </div>
        <div class="card">
          <p class="panel-title">Lambda response</p>
          <pre id="response-preview">Waiting for a request...</pre>
        </div>
      </div>
    </details>
  </main>

  <script src="app.js"></script>
</body>
</html>
